<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SentiCam - Intelligent Threat Detection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a192f 0%, #162947 100%);
            color: #e6f1ff;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            color: #64ffda;
            margin-right: 15px;
        }
        
        .logo h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg, #64ffda, #00b3ff);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .status-bar {
            display: flex;
            align-items: center;
            background: rgba(10, 25, 47, 0.7);
            padding: 10px 20px;
            border-radius: 30px;
            border: 1px solid rgba(100, 255, 218, 0.3);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            background: #64ffda;
            border-radius: 50%;
            margin-right: 10px;
            box-shadow: 0 0 10px #64ffda;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            font-size: 1.5rem;
            color: #ccd6f6;
        }
        
        .section-title i {
            margin-right: 10px;
            color: #64ffda;
        }
        
        .video-container {
            position: relative;
            background: #0a192f;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }
        
        #live-video {
            width: 100%;
            display: block;
            height: 450px;
            object-fit: cover;
            background: #020c1b;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to bottom, rgba(2, 12, 27, 0.8) 0%, transparent 100%);
            padding: 20px;
            color: white;
        }
        
        .video-overlay h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .video-overlay p {
            font-size: 0.9rem;
            color: #ccd6f6;
        }
        
        .ai-analysis {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(2, 12, 27, 0.8) 0%, transparent 100%);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            color: white;
        }
        
        .ai-analysis i {
            color: #64ffda;
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .video-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: rgba(100, 255, 218, 0.1);
            color: #64ffda;
            border: 1px solid rgba(100, 255, 218, 0.3);
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: rgba(100, 255, 218, 0.2);
            transform: translateY(-2px);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .analysis-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .analysis-box {
            background: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .analysis-title {
            color: #8892b0;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .analysis-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #64ffda;
        }
        
        .analysis-value.threat {
            color: #ff4d4d;
            animation: glow 1s infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 5px #ff4d4d; }
            to { text-shadow: 0 0 15px #ff4d4d; }
        }
        
        .alerts-section {
            background: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(100, 255, 218, 0.2);
            height: fit-content;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .alert-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .alert-item {
            background: rgba(2, 12, 27, 0.5);
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #64ffda;
        }
        
        .alert-item.safe {
            border-left-color: #64ffda;
        }
        
        .alert-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .alert-time {
            color: #8892b0;
            font-size: 0.8rem;
        }
        
        .alert-type {
            color: #64ffda;
            font-weight: 600;
        }
        
        .alert-content p {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .video-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .video-card {
            background: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .video-thumb {
            height: 180px;
            background: linear-gradient(135deg, #0a192f 0%, #162947 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .video-thumb {
            position: relative;
            height: 180px; /* keep same as you had */
            overflow: hidden;
}

/* injected thumbnail video */
.thumb-video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  pointer-events: none; /* so clicks hit card, not the internal video */
}

/* keep the play icon centered â€” we will hide it once video loaded */
.video-thumb i {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 5;
  font-size: 3rem;
  color: rgba(255,255,255,0.8);
  transition: opacity .25s ease;
}

/* hide play icon when class 'has-thumb-video' is present */
.video-thumb.has-thumb-video i { opacity: 0; pointer-events: none; }

        .video-thumb i {
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .threat-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4d4d;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .video-info {
            padding: 15px;
        }
        
        .video-title {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #ccd6f6;
        }
        
        .video-desc {
            color: #8892b0;
            font-size: 0.9rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #8892b0;
            font-size: 0.9rem;
            border-top: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        footer p {
            margin-bottom: 5px;
        }
        
        .alert-banner {
            position: fixed;
            top: -100px;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, #ff4d4d, #ff3333);
            color: white;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(255, 77, 77, 0.3);
            transition: top 0.5s ease;
        }
        
        .alert-banner.show {
            top: 0;
        }
        
        .alert-banner i {
            font-size: 2rem;
            margin-right: 15px;
        }
        
        .alert-banner h3 {
            margin-bottom: 5px;
        }
        
        .video-source-select {
            margin: 15px 0;
            display: flex;
            align-items: center;
        }
        
        .video-source-select label {
            margin-right: 10px;
            color: #8892b0;
        }
        
        .video-source-select select {
            background: #0a192f;
            color: #64ffda;
            border: 1px solid #64ffda;
            padding: 8px 15px;
            border-radius: 30px;
            outline: none;
        }
        
        .settings-panel {
            background: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .settings-title {
            color: #64ffda;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .settings-title i {
            margin-right: 10px;
            color: #64ffda;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .setting-item {
            margin-bottom: 15px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 5px;
            color: #8892b0;
        }
        
        .setting-item select, .setting-item input {
            width: 100%;
            background: #0a192f;
            color: #64ffda;
            border: 1px solid #64ffda;
            padding: 8px 15px;
            border-radius: 30px;
            outline: none;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #0a192f;
            border: 1px solid #64ffda;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 3px;
            background-color: #64ffda;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: rgba(100, 255, 218, 0.2);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .dashboard-card {
            background: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .card-icon {
            font-size: 2.5rem;
            color: #64ffda;
            margin-bottom: 15px;
        }
        
        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: #64ffda;
            margin-bottom: 5px;
        }
        
        .card-label {
            color: #8892b0;
            font-size: 0.9rem;
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .status-bar {
                margin-top: 15px;
            }
            
            .video-controls {
                justify-content: center;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 576px) {
            .video-controls .btn {
                flex: 1;
                min-width: 120px;
                justify-content: center;
            }
            
            .analysis-section {
                grid-template-columns: 1fr;
            }
            
            .video-source-select {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .video-source-select select {
                width: 100%;
                margin-top: 8px;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="alert-banner" id="alertBanner">
        <i class="fas fa-exclamation-triangle"></i>
        <div>
            <h3>DANGER DETECTED!</h3>
            <p>Screaming and aggressive behavior identified</p>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-camera logo-icon"></i>
                <h1>SentiCam</h1>
            </div>
            <div class="status-bar">
                <div class="status-indicator"></div>
                <span>AI Monitoring Active - <span id="threatCount">3</span> Threats Detected</span>
            </div>
        </header>
        
        <div class="dashboard-cards">
            <div class="dashboard-card">
                <i class="fas fa-video card-icon"></i>
                <div class="card-value" id="totalCameras">5</div>
                <div class="card-label">Active Cameras</div>
            </div>
            <div class="dashboard-card">
                <i class="fas fa-shield-alt card-icon"></i>
                <div class="card-value" id="protectedAreas">12</div>
                <div class="card-label">Protected Areas</div>
            </div>
            <div class="dashboard-card">
                <i class="fas fa-bell card-icon"></i>
                <div class="card-value" id="todayAlerts">4</div>
                <div class="card-label">Today's Alerts</div>
            </div>
            <div class="dashboard-card">
                <i class="fas fa-chart-line card-icon"></i>
                <div class="card-value">97%</div>
                <div class="card-label">System Accuracy</div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="video-section">
                <h2 class="section-title"><i class="fas fa-video"></i> Live Feed Monitoring</h2>
                
                <div class="video-source-select">
                    <label for="videoSource">Video Source:</label>
                    <select id="videoSource">
                        <option value="simulation">Simulation Mode</option>
                        <option value="webcam">Webcam Feed</option>
                        <option value="ipcam">IP Camera (RTSP)</option>
                        <option value="file">Upload Video File</option>
                    </select>
                </div>
                
                <div class="video-container">
                    <video id="live-video" autoplay muted playsinline>
                        Your browser does not support the video element.
                    </video>
                    <div class="video-overlay">
                        <h3>Live CCTV Feed - CCTV Camera </h3>
                        <p>AI Analysis in Progress</p>
                    </div>
                    <div class="ai-analysis">
                        <i class="fas fa-brain"></i>
                        <span>AI Analyzing: <span id="analysis-status">Screaming detected (87%)</span></span>
                    </div>
                </div> 
                
                <div class="video-controls">
                    <button class="btn" id="playBtn"><i class="fas fa-play"></i> Play</button>
                    <button class="btn" id="pauseBtn"><i class="fas fa-pause"></i> Pause</button>
                    <button class="btn" id="muteBtn"><i class="fas fa-volume-mute"></i> Mute Audio</button>
                    <button class="btn" id="fullscreenBtn"><i class="fas fa-expand"></i> Fullscreen</button>
                    <input type="file" id="fileInput" accept="video/*" style="display: none;">
                    <button class="btn" id="uploadBtn"><i class="fas fa-upload"></i> Upload Video</button>
                    <button class="btn" id="settingsBtn"><i class="fas fa-cog"></i> Settings</button>
                </div>
                
                <div class="analysis-section">
                    <div class="analysis-box">
                        <div class="analysis-title">Current Threat Level</div>
                        <div class="analysis-value threat" id="threatLevel">HIGH</div>
                    </div>
                    <div class="analysis-box">
                        <div class="analysis-title">AI Confidence</div>
                        <div class="analysis-value" id="confidenceLevel">87%</div>
                    </div>
                    <div class="analysis-box">
                        <div class="analysis-title">Detection Type</div>
                        <div class="analysis-value" id="detectionType">Screaming</div>
                    </div>
                    <div class="analysis-box">
                        <div class="analysis-title">Response Time</div>
                        <div class="analysis-value" id="responseTime">2.4s</div>
                    </div>
                </div>
                
                <div class="settings-panel" id="settingsPanel" style="display: none;">
                    <h3 class="settings-title"><i class="fas fa-cog"></i> Detection Settings</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="sensitivity">Detection Sensitivity</label>
                            <select id="sensitivity">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="alertVolume">Alert Volume</label>
                            <input type="range" id="alertVolume" min="0" max="100" value="80">
                        </div>
                        <div class="setting-item">
                            <label for="autoRecording">Auto Recording</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoRecording" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label for="alertNotifications">Alert Notifications</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="alertNotifications" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="alerts-section">
                <h2 class="section-title"><i class="fas fa-bell"></i> AI Alerts</h2>
                
                <div class="alert-list" id="alertList">
                    <div class="alert-item">
                        <div class="alert-header">
                            <span class="alert-time">Just now</span>
                            <span class="alert-type">DANGER: Screaming Detected</span>
                        </div>
                        <div class="alert-content">
                            <p>High-pitched screaming detected with 87% confidence. Possible distress situation.</p>
                            <p>Location: Camera 12 - Downtown Market Street</p>
                        </div>
                    </div>
                    
                    <div class="alert-item safe">
                        <div class="alert-header">
                            <span class="alert-time">5 mins ago</span>
                            <span class="alert-type">SAFE: Children Playing</span>
                        </div>
                        <div class="alert-content">
                            <p>Children giggling and shouting detected with 95% confidence. Determined to be safe play.</p>
                            <p>Location: Camera 7 - Central Park Playground</p>
                        </div>
                    </div>
                    
                    <div class="alert-item">
                        <div class="alert-header">
                            <span class="alert-time">27 mins ago</span>
                            <span class="alert-type">DANGER: Aggressive Behavior</span>
                        </div>
                        <div class="alert-content">
                            <p>Aggressive shouting and posturing detected with 92% confidence.</p>
                            <p>Location: Camera 3 - Financial District</p>
                        </div>
                    </div>
                    
                    <div class="alert-item safe">
                        <div class="alert-header">
                            <span class="alert-time">1 hour ago</span>
                            <span class="alert-type">SAFE: Street Performance</span>
                        </div>
                        <div class="alert-content">
                            <p>Loud singing and crowd reactions detected with 89% confidence. Determined to be street performance.</p>
                            <p>Location: Camera 9 - Main Square</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 class="section-title"><i class="fas fa-film"></i> Recorded Videos</h2>
        <div class="video-list">
            <div class="video-card" data-video="danger" data-src="D:\Techatronix\danger1.mp4">
                <div class="video-thumb">
                    <i class="fas fa-play-circle"></i>
                    <div class="threat-tag">DANGER</div>
                </div>
                <div class="video-info">
                    <h3 class="video-title">Market Street Altercation</h3>
                    <p class="video-desc">Physical fight detected â€¢ 12:42 PM</p>
                </div>
            </div>
            
            <div class="video-card" data-video="safe" data-src="D:\Techatronix\safe1.mp4">
                <div class="video-thumb">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="video-info">
                    <h3 class="video-title">Party Celebration</h3>
                    <p class="video-desc">Festive gathering â€¢ 11:15 AM</p>
                </div>
            </div>
            
            <div class="video-card" data-video="danger" data-src="D:\Techatronix\danger2.mp4">
                <div class="video-thumb">
                    <i class="fas fa-play-circle"></i>
                    <div class="threat-tag">DANGER</div>
                </div>
                <div class="video-info">
                    <h3 class="video-title">Parking Lot Dispute</h3>
                    <p class="video-desc">Verbal argument escalating â€¢ 10:03 AM</p>
                </div>
            </div>
            
            <div class="video-card" data-video="safe" data-src="D:\Techatronix\safe2.mp4">
                <div class="video-thumb">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="video-info">
                    <h3 class="video-title">Morning Traffic</h3>
                    <p class="video-desc">Rush hour analysis â€¢ 8:45 AM</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>SentiCam Monitoring System &copy; 2023 | Prototype Version 2.1</p>
            <p>This system uses artificial intelligence to analyze video footage and detect potential security threats.</p>
        </footer>
    </div>

       <script>
        // Video elements
        const video = document.getElementById('live-video');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const uploadBtn = document.getElementById('uploadBtn');
        const fileInput = document.getElementById('fileInput');
        const videoSource = document.getElementById('videoSource');
        const alertBanner = document.getElementById('alertBanner');
        const threatLevel = document.getElementById('threatLevel');
        const confidenceLevel = document.getElementById('confidenceLevel');
        const analysisStatus = document.getElementById('analysis-status');
        const alertList = document.getElementById('alertList');
        const threatCount = document.getElementById('threatCount');
        
        // Video stream variables
        let stream = null;
        let isPlaying = false;
        let isMuted = true;
        let threatCounter = 4;
        let analysisInterval;
        
        // Initialize with the requested file
        video.src = "senticam_test.mp4";
        
        // Video source change handler
        videoSource.addEventListener('change', function() {
            stopAllStreams();
            clearInterval(analysisInterval);
            
            switch(this.value) {
                case 'simulation':
                    video.src = "senticam_test.mp4";
                    video.play();
                    isPlaying = true;
                    startAnalysis();
                    break;
                    
                case 'webcam':
                    startWebcam();
                    break;
                    
                case 'ipcam':
                    // For IP cameras, you would typically need a proxy server
                    // due to browser security restrictions
                    alert("IP camera feature requires server-side setup. Using simulation mode.");
                    videoSource.value = "simulation";
                    video.src = "senticam_test.mp4";
                    video.play();
                    isPlaying = true;
                    startAnalysis();
                    break;
                    
                case 'file':
                    fileInput.click();
                    break;
            }
        });
        
        // Webcam function
        async function startWebcam() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: true, 
                    audio: true 
                });
                video.srcObject = stream;
                video.play();
                isPlaying = true;
                startAnalysis();
            } catch (err) {
                console.error("Error accessing webcam:", err);
                alert("Could not access webcam. Using simulation mode.");
                videoSource.value = "simulation";
                video.src = "senticam_test.mp4";
                video.play();
                isPlaying = true;
                startAnalysis();
            }
        }
        
        // File upload handler
        uploadBtn.addEventListener('click', function() {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
                stopAllStreams();
                const fileURL = URL.createObjectURL(this.files[0]);
                video.src = fileURL;
                video.play();
                isPlaying = true;
                startAnalysis();
            }
        });
        
        // Stop all media streams
        function stopAllStreams() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            if (video.srcObject) {
                video.srcObject = null;
            }
        }
        
        // Start analysis simulation
        function startAnalysis() {
            clearInterval(analysisInterval);
            analysisInterval = setInterval(simulateAnalysis, 10000);
        }
        
        // Simulate AI analysis (same as before)
        function simulateAnalysis() {
            if (window.incidentTriggered) return;    // <- prevent duplicates when timestamp trigger fired
            if (!isPlaying) return;
            
            const isThreat = Math.random() > 0.5;
            const confidence = Math.floor(Math.random() * 15) + 75;
            
            if (isThreat) {
                // Threat detected
                threatLevel.textContent = 'HIGH';
                threatLevel.classList.add('threat');
                confidenceLevel.textContent = `${confidence}%`;
                analysisStatus.textContent = `Screaming detected (${confidence}%)`;
                
                // Show alert banner
                alertBanner.querySelector('h3').textContent = 'DANGER DETECTED!';
                alertBanner.querySelector('p').textContent = 'Screaming and aggressive behavior identified';
                alertBanner.classList.add('show');
                
                // Add to alert list
                const newAlert = document.createElement('div');
                newAlert.className = 'alert-item';
                newAlert.innerHTML = `
                    <div class="alert-header">
                        <span class="alert-time">Just now</span>
                        <span class="alert-type">DANGER: Screaming Detected</span>
                    </div>
                    <div class="alert-content">
                        <p>High-pitched screaming detected with ${confidence}% confidence. Possible distress situation.</p>
                        <p>Location: Camera ${Math.floor(Math.random() * 20) + 1} - Downtown Area</p>
                    </div>
                `;
                
                alertList.insertBefore(newAlert, alertList.firstChild);
                
                // Update threat count
                threatCounter++;
                threatCount.textContent = threatCounter;
                
                // Hide banner after 5 seconds
                setTimeout(() => {
                    alertBanner.classList.remove('show');
                }, 5000);
            } else {
                // Safe situation
                threatLevel.textContent = 'LOW';
                threatLevel.classList.remove('threat');
                confidenceLevel.textContent = `${confidence}%`;
                analysisStatus.textContent = `Children playing (${confidence}%)`;
                
                // Add to alert list as safe
                const newAlert = document.createElement('div');
                newAlert.className = 'alert-item safe';
                newAlert.innerHTML = `
                    <div class="alert-header">
                        <span class="alert-time">Just now</span>
                        <span class="alert-type">SAFE: Children Playing</span>
                    </div>
                    <div class="alert-content">
                        <p>Children giggling and shouting detected with ${confidence}% confidence. Determined to be safe play.</p>
                        <p>Location: Camera ${Math.floor(Math.random() * 20) + 1} - Residential Area</p>
                    </div>
                `;
                
                alertList.insertBefore(newAlert, alertList.firstChild);
            }
        }
        
        // Button functionality
        playBtn.addEventListener('click', () => {
            video.play();
            isPlaying = true;
        });
        
        pauseBtn.addEventListener('click', () => {
            video.pause();
            isPlaying = false;
        });
        
        muteBtn.addEventListener('click', () => {
            isMuted = !isMuted;
            video.muted = isMuted;
            muteBtn.innerHTML = isMuted ? 
                '<i class="fas fa-volume-mute"></i> Unmute Audio' : 
                '<i class="fas fa-volume-up"></i> Mute Audio';
        });
        
        fullscreenBtn.addEventListener('click', () => {
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        });
        
        // Video card selection (same as before)
        document.querySelectorAll('.video-card').forEach(card => {
            card.addEventListener('click', () => {
                const type = card.getAttribute('data-video');
                
                if (type === 'danger') {
                    threatLevel.textContent = 'HIGH';
                    threatLevel.classList.add('threat');
                    confidenceLevel.textContent = '78%';
                    analysisStatus.textContent = 'Aggressive behavior detected (78%)';
                    
                    // Show alert banner
                    alertBanner.querySelector('h3').textContent = 'DANGER DETECTED!';
                    alertBanner.querySelector('p').textContent = 'Physical altercation identified';
                    alertBanner.classList.add('show');
                    
                    setTimeout(() => {
                        alertBanner.classList.remove('show');
                    }, 5000);
                } else {
                    threatLevel.textContent = 'LOW';
                    threatLevel.classList.remove('threat');
                    confidenceLevel.textContent = '95%';
                    analysisStatus.textContent = 'Children playing (95%)';
                }
            });
        });
        
        // Start initial analysis simulation
        startAnalysis();
    </script>

    <!-- Timestamp-trigger script (fires at configured second and injects sidebar alert) -->
<script>
/* ---------- Timestamp-trigger + sidebar incident injection (customized) ---------- */
(function () {
  const VIDEO_SELECTOR = '#live-video';
  const ALERT_BANNER_SELECTOR = '#alertBanner';
  const ALERT_LIST_SELECTOR = '#alertList';
  const THREAT_COUNT_SELECTOR = '#threatCount';
  const THREAT_LEVEL_SELECTOR = '#threatLevel';
  const CONFIDENCE_SELECTOR = '#confidenceLevel';
  const ANALYSIS_STATUS_SELECTOR = '#analysis-status';

  // CONFIG: change this to set a different trigger time
  const TARGET_TIMESTAMP_SECONDS = 6; // <-- set to 6 seconds (you requested 0.06 => interpreted as 0:06). If you meant 0.06s, set this to 0.06
  const TOLERANCE = 0.25;               // small tolerance for checks
  let watcherAttached = false;

  const video = document.querySelector(VIDEO_SELECTOR);
  if (!video) {
    console.warn('timestamp-trigger: video not found:', VIDEO_SELECTOR);
    return;
  }

  // Try to unmute & play â€” browsers may block audio until user gesture.
  function tryAutoUnmute() {
    try {
      video.muted = false;
      video.play().catch(() => {
        // if blocked, revert to muted and wait for first gesture
        video.muted = true;
        const enableSound = () => {
          try { video.muted = false; video.play(); } catch (e) {}
          window.removeEventListener('click', enableSound);
          window.removeEventListener('touchstart', enableSound);
        };
        window.addEventListener('click', enableSound, { once: true });
        window.addEventListener('touchstart', enableSound, { once: true });
      });
    } catch (e) {
      console.warn('timestamp-trigger: auto-unmute failed', e);
    }
  }

  // Call unmute attempt once on load (harmless if already unmuted)
  tryAutoUnmute();

  // Core trigger action â€” non-destructive (uses your existing elements & styles)
  function triggerIncidentAt(timestampSec) {
    if (window.incidentTriggered) return;
    window.incidentTriggered = true; // global flag used by simulateAnalysis

    // 1) Show top banner (your existing css 'show' class will handle animation)
    const banner = document.querySelector(ALERT_BANNER_SELECTOR);
    if (banner) {
      try {
        banner.querySelector('h3').textContent = 'DANGER DETECTED!';
        banner.querySelector('p').textContent = 'Screaming and aggressive behavior identified';
      } catch (e) {}
      banner.classList.add('show');
      // hide after 7s to match previous behavior
      setTimeout(() => banner.classList.remove('show'), 7000);
    }

    // 2) Update dashboard analysis UI elements (non-destructive)
    const threatEl = document.querySelector(THREAT_LEVEL_SELECTOR);
    const confEl = document.querySelector(CONFIDENCE_SELECTOR);
    const statusEl = document.querySelector(ANALYSIS_STATUS_SELECTOR);
    if (threatEl) { threatEl.textContent = 'HIGH'; threatEl.classList.add('threat'); }
    if (confEl)  confEl.textContent = '95%';
    if (statusEl) statusEl.textContent = 'Screaming detected (95%)';

    // 3) Insert a special incident panel into the alerts sidebar (keeps your .alert-item style)
    const alertList = document.querySelector(ALERT_LIST_SELECTOR);
    if (alertList) {
      const newAlert = document.createElement('div');
      newAlert.className = 'alert-item';
      // Use the requested static details exactly as provided
      newAlert.innerHTML = `
        <div class="alert-header">
          <span class="alert-time"><strong> CURRENT </strong></span>
          <span class="alert-type">DANGER: Armed Incident</span>
        </div>
        <div class="alert-content">
          <p><strong>Place:</strong> ICIC bank, Gandhi Nagar, Selaiyur, Tambaram, Chennai</p>
          <p><strong>Incident:</strong> Uses gun, people scared, lady shouts, money taken in frightened tone.</p>
          <p><strong>Time:</strong> <strong> CURRENT </strong> &nbsp;&nbsp; <strong>Date:</strong> 30.09.2025</p>
          <div style="margin-top:10px;">
            <button class="btn contact-police" type="button">Alert nearby police station</button>
          </div>
        </div>
      `;
      // Insert at the top (preserves your visuals)
      alertList.insertBefore(newAlert, alertList.firstChild);

      // Contact button behavior â€” opens dialer to emergency number
      const contactBtn = newAlert.querySelector('.contact-police');
      if (contactBtn) {
        contactBtn.addEventListener('click', () => {
          // change this number if you want a different target
          window.location.href = 'tel:100';
        });
      }
    } else {
      console.warn('timestamp-trigger: alert list not found:', ALERT_LIST_SELECTOR);
    }

    // 4) Update threat counter (non-destructive)
    const tc = document.querySelector(THREAT_COUNT_SELECTOR);
    if (tc) {
      const current = parseInt(tc.textContent || '0', 10);
      tc.textContent = isNaN(current) ? '1' : String(current + 1);
    }

    // 5) dispatch custom event in case other parts of your UI need to react
    try {
      document.dispatchEvent(new CustomEvent('senticam:incident', { detail: { timestamp: timestampSec } }));
    } catch (e) { /* ignore */ }
  }

  // attach a timeupdate listener (throttled)
  if (!watcherAttached) {
    let lastChecked = 0;
    video.addEventListener('timeupdate', () => {
      const t = video.currentTime || 0;
      if (t - lastChecked < 0.2) return; // throttle checks
      lastChecked = t;
      if (!window.incidentTriggered && (t + TOLERANCE >= TARGET_TIMESTAMP_SECONDS)) {
        // small delay so UI has time to update
        setTimeout(() => triggerIncidentAt(TARGET_TIMESTAMP_SECONDS), 150);
      }
    });
    // also check on loadedmetadata / seeked in case the video is loaded past the timestamp
    video.addEventListener('loadedmetadata', () => {
      if (video.currentTime + TOLERANCE >= TARGET_TIMESTAMP_SECONDS && !window.incidentTriggered) triggerIncidentAt(TARGET_TIMESTAMP_SECONDS);
    });
    video.addEventListener('seeked', () => {
      if (video.currentTime + TOLERANCE >= TARGET_TIMESTAMP_SECONDS && !window.incidentTriggered) triggerIncidentAt(TARGET_TIMESTAMP_SECONDS);
    });
    watcherAttached = true;
  }

})();
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // Query all video cards
  document.querySelectorAll('.video-card').forEach(card => {
    const thumb = card.querySelector('.video-thumb');
    if (!thumb) return;

    // get source from data-src or fallback to senticam_test.mp4
    const src = card.getAttribute('data-src') || 'senticam_test.mp4';

    // create the thumbnail video element
    const tvid = document.createElement('video');
    tvid.className = 'thumb-video';
    tvid.src = src;
    tvid.muted = true;           // must be muted to autoplay
    tvid.loop = true;
    tvid.playsInline = true;
    tvid.autoplay = true;
    tvid.preload = 'metadata';

    // insert at top of thumbnail
    thumb.insertBefore(tvid, thumb.firstChild);

    // once it can play, mark as having a video (hide play icon)
    tvid.addEventListener('canplay', () => {
      thumb.classList.add('has-thumb-video');
      // start playback (some browsers still require a gesture but muted autoplay usually works)
      tvid.play().catch(() => {});
    });

    // hide default icon if video errors
    tvid.addEventListener('error', () => {
      thumb.classList.remove('has-thumb-video');
    });

    // clicking the card will load into main #live-video
    card.addEventListener('click', (e) => {
      e.stopPropagation();
      const mainVideo = document.getElementById('live-video');
      if (!mainVideo) return;

      // stop any webcam streams (uses your existing function if present)
      try { stopAllStreams(); } catch (err) {}

      // If you prefer using srcObject for streams you can adapt this
      mainVideo.srcObject = null;
      mainVideo.src = src;
      mainVideo.muted = false; // play with audio when loaded (browser may still block until gesture)
      mainVideo.play().catch(() => {
        // if playback is blocked, keep it muted and play then user can unmute with UI
        mainVideo.muted = true;
        mainVideo.play().catch(() => {});
      });

      // set internal flags used by the rest of your code
      if (typeof startAnalysis === 'function') {
        // ensure analysis restarts for newly loaded file
        try {
          startAnalysis();
        } catch (err) {}
      }
      // reflect selected card's metadata (optional)
      const metaType = card.getAttribute('data-video');
      if (metaType === 'danger') {
        document.getElementById('threatLevel').textContent = 'HIGH';
        document.getElementById('threatLevel').classList.add('threat');
      } else {
        document.getElementById('threatLevel').textContent = 'LOW';
        document.getElementById('threatLevel').classList.remove('threat');
      }
    });
  });
});
</script>
</body>
</html>

